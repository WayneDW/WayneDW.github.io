<html>
<head>
    <title>Coupling by Reflection (II)</title>
    <meta charset='UTF-8'>
    <meta content='width=device-width, initial-scale=1' name='viewport'/>

    <meta name='description' content='Wei Deng is a machine learning researcher and applied mathematician.'>
    <meta name='keywords' content=''>
    <meta name='author' content='Wei Deng'>

    <link href='/css/blog.css' rel='stylesheet'/>
    <link href='/css/trac.css' rel='stylesheet'/>
    <link href='/css/markdown.css' rel='stylesheet'/>

    
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [ ['$$', '$$'], ["\\[","\\]"]],
      tags: 'ams',
      displayAlign: "center"
    }
  };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>

</head>
<body>
<div class='content'>
    <div class='nav'>
    <ul class='wrap'>
        <li><a href='/'>Home</a></li>
        <li><a href='/publications/'>Publications</a></li>
	<li><a href='/blog/'>Blog</a></li>
    </ul>
</div>

    <div class='front-matter'>
        <div class='wrap'>
            <h1>Coupling by Reflection (II)</h1>
            <h4>A general coupling technique for characterizing a broad range of diffusions.</h4>
            <div class='bylines'>
                <div class='byline'>
                    <!-- <h3>Published</h3> -->
                    <p>20 May 2023</p>
                </div>
            </div>
            <div class='clear'></div>
        </div>
    </div>
    <div class='wrap article'>
        <h3 id="limitations-of-synchronous-coupling">Limitations of Synchronous Coupling</h3>

<p>Given a $\kappa$-strongly convex drift $U$, we can apply the synchronous coupling for the diffusion process</p>

\[\begin{align}
  \mathrm{d}X_t = U(X_t)\mathrm{d}t+\mathrm{d}W_t\notag\\
  \mathrm{d}Y_t = U(Y_t)\mathrm{d}t+\mathrm{d}W_t.\notag\\
\end{align}\]

<p>Eliminating the Brownian motion, we obtain a contractivity property</p>

\[\begin{align}
  \|X_t-Y_t\|\leq \|X_0-Y_0\|^2 \exp(-\kappa t).\notag
\end{align}\]

<p>However, we cannot easily obtain the desired contraction when $U$ is not strongly convex. To address this issue, one should consider a more general coupling method based on a specic metric instead of the standard Euclidean metric. The diffusions may not contract almost surely, but rather in the average sense.</p>

<h3 id="reflection-coupling">Reflection Coupling</h3>

<p>Define the coupling time $T_c=\inf \{ t\geq 0  | X_t =Y_t \}$. By definition, we know that $X_t=Y_t$ for $t\geq T_c$ <a class="citation" href="#mufa_chen">(Chen &amp; Li, 1989)</a> <a class="citation" href="#reflection_coupling">(Eberle, 2011)</a> <a class="citation" href="#reflection_coupling_2">(Eberle, 2016)</a>  <a class="citation" href="#coupling_hmc">(N. Bou-Rabee &amp; Zimmer, 2020)</a>. When the drift term $U$ is zero, we observe that $\|X_t-Y_t\|$ remains fixed for any $t$ and synchronous coupling doesn’t induce any contraction.</p>

<p>Let’s explore an alternative coupling where the Brownian motion moves in the opposite direction. We anticipate with some probability the processes will merge [Why?].</p>

\[\begin{align}
  \mathrm{d}X_t &amp;= U(X_t)\mathrm{d}t+\mathrm{d}W_t\notag\\
  \mathrm{d}Y_t &amp;= U(Y_t)\mathrm{d}t+(\mathrm{I} - 2\cdot e_t e_t^{\intercal})\mathrm{d}W_t,\notag\\
\end{align}\]

<p>where $e_t=\mathbb{I}_{[X_t\neq Y_t]}\cdot \frac{X_t-Y_t}{\|X_t-Y_t\|}$ and one can identify that $\widetilde W_t=\int_0^t \big[\mathrm{I} - 2\cdot e_s e_s^{\intercal} \big]\mathrm{d} s$ is also a Brownian motion. In addition, $e_t e_t^{\intercal}$ is the orthogonal projection onto the unit vector $e_t$ <a href="https://textbooks.math.gatech.edu/ila/projections.html">[Hint]</a> and you can easily check that $e_t$ is the eigenvector of $\mathrm{I} - 2\cdot e_t e_t^{\intercal}$ with one eigenvalue $-1$..</p>

<h3 id="supermartingales">Supermartingales</h3>

<p>We first show $\exp(c\cdot t)f(G_t)$ is a supermartingale, where $G_t=\|X_t-Y_t\|$.</p>

<p>Apply Ito’s lemma to $f(G_t)$, where $f$ is a concave function to induce a new distance metric $d_f(X, Y)=f(\|X-Y\|)$ <a class="citation" href="#reflection_coupling">(Eberle, 2011)</a>.</p>

\[\begin{align}
  \mathrm{d} f(G_t)=2f'(R_t)\mathrm{d}W_t+\bigg\{f'(G_t)\cdot \bigg\langle U(X_t)-U(Y_t), \frac{X_t-Y_t}{\|X_t-Y_t\|}\bigg\rangle +2f''(G_t)\bigg\} \mathrm{d}t.\notag
\end{align}\]

<p>Assume $\langle U(X_t)-U(Y_t), X_t-Y_t\rangle \leq -\kappa(r) \frac{\|X_t-Y_t\|^2}{2}$, where $\kappa(r)$ is not necessarily positive</p>

\[\begin{align}
  \bigg\langle U(X_t)-U(Y_t), \frac{X_t-Y_t}{\|X_t-Y_t\|}\bigg\rangle \leq -\frac{1}{2} \cdot G_t \cdot\kappa(G_t). \notag
\end{align}\]

<p>Further including the integration factor $\exp(c\cdot t)$, we have</p>

\[\begin{align}
  \dfrac{\mathrm{d} \bigg[\exp(c\cdot t)f(G_t)\bigg]}{\exp(c\cdot t)}\leq 2f'(R_t) \mathrm{d}W_t + \bigg[-\frac{1}{2} G_t \cdot\kappa(G_t) f'(G_t)+2f''(G_t)+c \cdot f(G_t)\bigg]\mathrm{d}t. \notag
\end{align}\]

<p>In other words, it induces a supermartingale when we have</p>

\[\begin{align}
-\frac{1}{2} G_t \cdot\kappa(G_t) f'(G_t)+2f''(G_t)+c \cdot f(G_t)\leq 0.\notag
\end{align}\]

<p>It implies that a proper $f$ may help us obtain the desired result</p>

\[\begin{align}
  \mathrm{E}[f(\|X_t-Y_t\|)] \leq f(\|X_0-Y_0\|)\cdot \exp(-c\cdot t).\notag
\end{align}\]

<h3 id="how-to-build-such-an-f">How to build such an $f$</h3>

<h4 id="a-simple-case-when-c--0">A simple case when $c = 0$</h4>

<p>We propose to find a $f$ that satisfies</p>

\[\begin{align}
f''(G_t)\leq \frac{1}{4} G_t \cdot\kappa(G_t) f'(G_t).\notag
\end{align}\]

<p>The worst case is given by $f(R)=\int_0^{R} f’(s) \mathrm{d}s$, where $f’$ is solved by Growall inequality</p>

\[\begin{align}
f'(R)&amp;=\exp\bigg\{\int_0^R\frac{1}{4} s \cdot\kappa(G_t) \mathrm{d}s\bigg\}.\notag
\end{align}\]

<h4 id="extention-to-c0">Extention to $c&gt;0$</h4>

<p>We aim to obtain the following dimension-independent bound in $R, L\in [0, \infty)$ <a class="citation" href="#reflection_coupling">(Eberle, 2011)</a>.</p>

<p>The general idea is to permit strong convexity outside of a ball with a given radius, within which local non-convexity is allowed.</p>

<p>$-\mathbb{I}_{[\|X_t-Y_t\|&lt; R]} L{\|X_t-Y_t\|^2}\leq \langle U(X_t)-U(Y_t), X_t-Y_t\rangle \leq \mathbb{I}_{[\|X_t-Y_t\|\geq R]} K{\|X_t-Y_t\|^2}.$</p>

    </div>
    <div id='bibliography'>
        <div class='wrap'>
            <ol class="bibliography"><li><span id="mufa_chen">Chen, M., &amp; Li, S. (1989). Coupling Methods for Multidimensional Diffusion Processes. <i>Annals of Probability</i>.</span></li>
<li><span id="reflection_coupling">Eberle, A. (2011). Reflection Coupling and Wasserstein Contractivity without Convexity. <i>Comptes Rendus Mathematique</i>.</span></li>
<li><span id="reflection_coupling_2">Eberle, A. (2016). Reflection couplings and contraction rates for diffusions. <i>Prob. Theo. Related. Fields</i>.</span></li>
<li><span id="coupling_hmc">N. Bou-Rabee, A. E., &amp; Zimmer, R. (2020). Coupling and convergence for Hamiltonian Monte Carlo. <i>Annals of Applied Probability</i>.</span></li></ol>
        </div>
    </div>
</div>
</body>
</html>
