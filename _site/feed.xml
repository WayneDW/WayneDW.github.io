<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2024-03-07T19:09:02-08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Wei Deng / 邓伟</title><subtitle>Ph.D. candidate in Applied Math at Purdue University</subtitle><author><name>Wei Deng</name></author><entry><title type="html">Flow Matching and Stochastic Interpolant</title><link href="http://localhost:4000/posts/flow_match_stochastic_interpolant/" rel="alternate" type="text/html" title="Flow Matching and Stochastic Interpolant" /><published>2023-08-10T00:00:00-07:00</published><updated>2023-08-10T00:00:00-07:00</updated><id>http://localhost:4000/posts/neraul-ode</id><content type="html" xml:base="http://localhost:4000/posts/flow_match_stochastic_interpolant/"><![CDATA[<p>DDPM paper: https://arxiv.org/pdf/2006.11239.pdf
Score matching tutorial: https://drive.google.com/file/d/1DYHDbt1tSl9oqm3O333biRYzSCOtdtmn/view
alpha blending: https://ggx-research.github.io/publication/2023/05/10/publication-iadb.html</p>

<p>learning sde can be converted to learning ode, in that case, will that resemble flow matching/ alpha blending?</p>]]></content><author><name>Wei Deng</name></author><category term="Diffusion Model" /><summary type="html"><![CDATA[DDPM paper: https://arxiv.org/pdf/2006.11239.pdf Score matching tutorial: https://drive.google.com/file/d/1DYHDbt1tSl9oqm3O333biRYzSCOtdtmn/view alpha blending: https://ggx-research.github.io/publication/2023/05/10/publication-iadb.html]]></summary></entry><entry><title type="html">Implicit Ridge Regularization</title><link href="http://localhost:4000/posts/flow_diffusion_PDE/" rel="alternate" type="text/html" title="Implicit Ridge Regularization" /><published>2023-07-01T00:00:00-07:00</published><updated>2023-07-01T00:00:00-07:00</updated><id>http://localhost:4000/posts/flow-diffusion-PDE</id><content type="html" xml:base="http://localhost:4000/posts/flow_diffusion_PDE/"><![CDATA[#### Ridge Regression with $n\gg d$: Bias-variance trade-off

We study the ordinary linear regression

$$\begin{align}
  \mathcal{L}=\|\mathrm{y}-\mathrm{X} {\beta}\|_2^2.\notag\\
\end{align}$$

where $\mathrm{X}\in \mathbb{R}^{n\times d}$ and is full rank. The solution follows that $\widehat \beta=(\mathrm{X}^\intercal \mathrm{X})^{-1} \mathrm{X} \mathrm{y}$.

However, $(\mathrm{X}^\intercal \mathrm{X})^{-1}$ is often poorly conditioned, which leads to a large prediction variance. To solve this issue, a standard technique is to consider the Tikhonov regularization through a $l_2$ penalty.

$$\begin{align}
  \mathcal{L}_{\lambda}=\|\mathrm{y}-\mathrm{X} {\beta}\|_2^2 + \lambda \|\beta\|_2^2.\notag\\
\end{align}$$

The solution follows that


$$\begin{align}
  \widehat \beta_{\lambda}=(\mathrm{X}^\intercal \mathrm{X} + \lambda \mathrm{I})^{-1} \mathrm{X} \mathrm{y} \label{ridge_solution}.
\end{align}$$


Increasing $\lambda$ leads to a larger bias but also yields a smaller prediction variance.

#### Ridge Regression with $d\gg n$: Minimum-norm estimator {% cite implicit_ridge %}



Taking the limit $\lambda \rightarrow 0$ in Eq.\eqref{ridge_solution}, we have

$$\begin{align}
    \widehat \beta_{0} = \lim_{\lambda \rightarrow 0}\widehat \beta_{\lambda}= \lim_{\lambda \rightarrow 0} \mathrm{V}\left[\dfrac{\mathrm{S}}{\mathrm{S}^2 + \lambda} \right] \mathrm{U}^\intercal \mathrm{y}=\mathrm{V} \mathrm{S}^{-1}\mathrm{U}^\intercal \mathrm{y}=\mathrm{X}^{+}\mathrm{y}.\label{solution}
\end{align}$$

where $\mathrm{X}=\mathrm{U} \mathrm{S} \mathrm{V}^\intercal$ by SVD decomposition, $\mathrm{U}$ and $\mathrm{V}$ are two orthogonal matrices. $\mathrm{X}^{+}=\mathrm{X}^\intercal (\mathrm{X} \mathrm{X}^\intercal)^{-1}$ is the pseudo-inverse of $\mathrm{X}$ (invertible since $\mathrm{X}$ is full rank).


We can easily verify that $\widehat \beta_{0}$ is a solution of $\mathrm{y}-\mathrm{X} {\beta}=0$ because 

$$\begin{align}
    \|\mathrm{y}-\mathrm{X} \widehat{\beta}_0 \|_2 = \| \mathrm{y}-\mathrm{X} \mathrm{X}^{+}\mathrm{y} \|_2=\| \mathrm{y}-\mathrm{y} \|_2=0.\notag
\end{align}$$

Moreover, $\widehat \beta_{0}$ is the minimum-norm estimator in $l_2$

$$\begin{align}
    \widehat \beta_{0} = \text{argmin}_{\beta} \big\{\|\beta\|_2^2 \ \ \big| \ \big\| \mathrm{y}-\mathrm{X} \beta \|_2^2=0 \big\}. \notag
\end{align}$$

Proof:

For any $\beta$ that solves $\mathrm{y}-\mathrm{X} {\beta}=0$, we have $\mathrm{X} \big(\widehat \beta_{0} - \beta \big) = 0.$

Next, we proceed to show $(\widehat \beta_{0} - {\beta})\perp \widehat \beta_{0}$. By Eq.\eqref{solution}, we have 

$$\begin{align}
    \big(\widehat \beta_{0} - {\beta} \big)^{\intercal} \widehat \beta_{0} = \big(\widehat \beta_{0} - {\beta} \big)^{\intercal} \mathrm{X}^\intercal (\mathrm{X} \mathrm{X}^\intercal)^{-1}\mathrm{y} = \big(\mathrm{X}\big(\widehat \beta_{0} - {\beta} \big)\big)^{\intercal} (\mathrm{X} \mathrm{X}^\intercal)^{-1}\mathrm{y}=0.
\end{align}$$

This implies that 

$$\begin{align}
    \| \beta \|_2^2 = \|\beta - \widehat\beta_0 + \widehat \beta_0\|_2^2 = \|\beta - \widehat\beta_0\|_2^2 + \|\widehat \beta_0\|_2^2\geq  \|\widehat \beta_0\|_2^2.
\end{align}$$


For interested readers on the extension of deep neural networks, we refer interested readers to the study in {% cite fit_without_fear %}.]]></content><author><name>Wei Deng</name></author><category term="Regression" /><summary type="html"><![CDATA[Ridge Regression with $n\gg d$: Bias-variance trade-off]]></summary></entry><entry><title type="html">Coupling by Reflection (II)</title><link href="http://localhost:4000/posts/coupling_by_reflection/" rel="alternate" type="text/html" title="Coupling by Reflection (II)" /><published>2023-05-20T00:00:00-07:00</published><updated>2023-05-20T00:00:00-07:00</updated><id>http://localhost:4000/posts/Coupling-by-Reflection</id><content type="html" xml:base="http://localhost:4000/posts/coupling_by_reflection/"><![CDATA[<h3 id="limitations-of-synchronous-coupling">Limitations of Synchronous Coupling</h3>

<p>Given a $\kappa$-strongly convex drift $U$, we can apply the synchronous coupling for the diffusion process</p>

\[\begin{align}
  \mathrm{d}X_t = U(X_t)\mathrm{d}t+\mathrm{d}W_t\notag\\
  \mathrm{d}Y_t = U(Y_t)\mathrm{d}t+\mathrm{d}W_t.\notag\\
\end{align}\]

<p>Eliminating the Brownian motion, we obtain a contractivity property</p>

\[\begin{align}
  \|X_t-Y_t\|\leq \|X_0-Y_0\|^2 \exp(-\kappa t).\notag
\end{align}\]

<p>However, we cannot easily obtain the desired contraction when $U$ is not strongly convex. To address this issue, one should consider a more general coupling method based on a specic metric instead of the standard Euclidean metric. The diffusions may not contract almost surely, but rather in the average sense.</p>

<h3 id="reflection-coupling">Reflection Coupling</h3>

<p>Define the coupling time $T_c=\inf \{ t\geq 0  | X_t =Y_t \}$. By definition, we know that $X_t=Y_t$ for $t\geq T_c$ <a class="citation" href="#mufa_chen">(Chen &amp; Li, 1989)</a> <a class="citation" href="#reflection_coupling">(Eberle, 2011)</a> <a class="citation" href="#reflection_coupling_2">(Eberle, 2016)</a>  <a class="citation" href="#coupling_hmc">(N. Bou-Rabee &amp; Zimmer, 2020)</a>. When the drift term $U$ is zero, we observe that $\|X_t-Y_t\|$ remains fixed for any $t$ and synchronous coupling doesn’t induce any contraction.</p>

<p>Let’s explore an alternative coupling where the Brownian motion moves in the opposite direction. We anticipate with some probability the processes will merge [Why?].</p>

\[\begin{align}
  \mathrm{d}X_t &amp;= U(X_t)\mathrm{d}t+\mathrm{d}W_t\notag\\
  \mathrm{d}Y_t &amp;= U(Y_t)\mathrm{d}t+(\mathrm{I} - 2\cdot e_t e_t^{\intercal})\mathrm{d}W_t,\notag\\
\end{align}\]

<p>where $e_t=\mathbb{I}_{[X_t\neq Y_t]}\cdot \frac{X_t-Y_t}{\|X_t-Y_t\|}$ and one can identify that $\widetilde W_t=\int_0^t \big[\mathrm{I} - 2\cdot e_s e_s^{\intercal} \big]\mathrm{d} s$ is also a Brownian motion. In addition, $e_t e_t^{\intercal}$ is the orthogonal projection onto the unit vector $e_t$ <a href="https://textbooks.math.gatech.edu/ila/projections.html">[Hint]</a> and you can easily check that $e_t$ is the eigenvector of $\mathrm{I} - 2\cdot e_t e_t^{\intercal}$ with one eigenvalue $-1$..</p>

<h3 id="supermartingales">Supermartingales</h3>

<p>We first show $\exp(c\cdot t)f(G_t)$ is a supermartingale, where $G_t=\|X_t-Y_t\|$.</p>

<p>Apply Ito’s lemma to $f(G_t)$, where $f$ is a concave function to induce a new distance metric $d_f(X, Y)=f(\|X-Y\|)$ <a class="citation" href="#reflection_coupling">(Eberle, 2011)</a>.</p>

\[\begin{align}
  \mathrm{d} f(G_t)=2f'(R_t)\mathrm{d}W_t+\bigg\{f'(G_t)\cdot \bigg\langle U(X_t)-U(Y_t), \frac{X_t-Y_t}{\|X_t-Y_t\|}\bigg\rangle +2f''(G_t)\bigg\} \mathrm{d}t.\notag
\end{align}\]

<p>Assume $\langle U(X_t)-U(Y_t), X_t-Y_t\rangle \leq -\kappa(r) \frac{\|X_t-Y_t\|^2}{2}$, where $\kappa(r)$ is not necessarily positive</p>

\[\begin{align}
  \bigg\langle U(X_t)-U(Y_t), \frac{X_t-Y_t}{\|X_t-Y_t\|}\bigg\rangle \leq -\frac{1}{2} \cdot G_t \cdot\kappa(G_t). \notag
\end{align}\]

<p>Further including the integration factor $\exp(c\cdot t)$, we have</p>

\[\begin{align}
  \dfrac{\mathrm{d} \bigg[\exp(c\cdot t)f(G_t)\bigg]}{\exp(c\cdot t)}\leq 2f'(R_t) \mathrm{d}W_t + \bigg[-\frac{1}{2} G_t \cdot\kappa(G_t) f'(G_t)+2f''(G_t)+c \cdot f(G_t)\bigg]\mathrm{d}t. \notag
\end{align}\]

<p>In other words, it induces a supermartingale when we have</p>

\[\begin{align}
-\frac{1}{2} G_t \cdot\kappa(G_t) f'(G_t)+2f''(G_t)+c \cdot f(G_t)\leq 0.\notag
\end{align}\]

<p>It implies that a proper $f$ may help us obtain the desired result</p>

\[\begin{align}
  \mathrm{E}[f(\|X_t-Y_t\|)] \leq f(\|X_0-Y_0\|)\cdot \exp(-c\cdot t).\notag
\end{align}\]

<h3 id="how-to-build-such-an-f">How to build such an $f$</h3>

<h4 id="a-simple-case-when-c--0">A simple case when $c = 0$</h4>

<p>We propose to find a $f$ that satisfies</p>

\[\begin{align}
f''(G_t)\leq \frac{1}{4} G_t \cdot\kappa(G_t) f'(G_t).\notag
\end{align}\]

<p>The worst case is given by $f(R)=\int_0^{R} f’(s) \mathrm{d}s$, where $f’$ is solved by Growall inequality</p>

\[\begin{align}
f'(R)&amp;=\exp\bigg\{\int_0^R\frac{1}{4} s \cdot\kappa(G_t) \mathrm{d}s\bigg\}.\notag
\end{align}\]

<h4 id="extention-to-c0">Extention to $c&gt;0$</h4>

<p>We aim to obtain the following dimension-independent bound in $R, L\in [0, \infty)$ <a class="citation" href="#reflection_coupling">(Eberle, 2011)</a>.</p>

<p>The general idea is to permit strong convexity outside of a ball with a given radius, within which local non-convexity is allowed.</p>

<p>$-\mathbb{I}_{[\|X_t-Y_t\|&lt; R]} L{\|X_t-Y_t\|^2}\leq \langle U(X_t)-U(Y_t), X_t-Y_t\rangle \leq \mathbb{I}_{[\|X_t-Y_t\|\geq R]} K{\|X_t-Y_t\|^2}.$</p>]]></content><author><name>Wei Deng</name></author><category term="Coupling" /><summary type="html"><![CDATA[Limitations of Synchronous Coupling]]></summary></entry><entry><title type="html">Girsanov and MLE</title><link href="http://localhost:4000/posts/Girsanov_MLE/" rel="alternate" type="text/html" title="Girsanov and MLE" /><published>2023-03-20T00:00:00-07:00</published><updated>2023-03-20T00:00:00-07:00</updated><id>http://localhost:4000/posts/Girsanov-Likelihood</id><content type="html" xml:base="http://localhost:4000/posts/Girsanov_MLE/"><![CDATA[<h3 id="maximum-likelihood-estimation">Maximum likelihood estimation</h3>

<p>Given $N$ independent observations, the likelihood function given $\theta=(\mu, \sigma)$ follows that</p>

\[\begin{align}
\mathcal{L}(\{x_i\}_{i=1}^N|\theta)=\prod_{i=1}^N f(x_i|\theta),\notag
\end{align}\]

<p>which models the density of the random variable $X$. The maximum likelihood estimator (MLE) is given by</p>

\[\begin{align}
\widehat\theta=\text{argmax} \mathcal{L}(\mathbf{x}|\theta),\notag
\end{align}\]

<p>where $\mathbf{x}=\{x_i\}_{i=1}^N$. When $X$ is a Gaussian random variable that follows $X\sim \mathcal{N}(\mu, \sigma^2)$. The likelihood function is expressed as</p>

\[\begin{align}\label{MLE}
\mathcal{L}(\{x_i\}_{i=1}^N|\theta)=\bigg(\frac{1}{\sqrt{2\pi \sigma^2}}\bigg)^{N/2} \exp\bigg(-\frac{\sum_{i=1}^N (x_i-\mu)^2}{2\sigma^2}\bigg).
\end{align}\]

<p>Taking the gradient w.r.t. $\mu$ and $\sigma^2$, we have</p>

\[\begin{align}
\widehat \mu=\frac{1}{N}\sum_{i=1}^N x_i, \quad \widehat\sigma^2=\frac{1}{N} \sum_{i=1}^N (x_i-\widehat \mu)^2.\notag
\end{align}\]

<h3 id="girsanov-theorem">Girsanov theorem</h3>

<p>Assume we have a diffusion process</p>

\[\begin{align}
\mathrm{d}X_t = b(X_t;\theta)\mathrm{d}t+\sigma\mathrm{d}W_t.\notag
\end{align}\]

<p>We observe the whole path of the process $X_t$ from time $[0, T]$. Denote by $\mathbb{P}_X$ the law of the process on the path space, which is absolutely continuous w.r.t. the Wiener measure. The density of $\mathbb{P}_X$ w.r.t. the Wiener measure is determined by the Radon-Nikodym derivative</p>

\[\begin{align}\label{girsanov}
\frac{\mathrm{d}\mathbb{P}_X}{\mathrm{d}\mathbb{P}_W}=\exp\bigg(\frac{1}{\sigma}\int_0^T b(X_s; \theta)\mathrm{d}W_s-\int_0^T \frac{b^2(X_s;\theta)}{2\sigma^2}\mathrm{d}s \bigg).
\end{align}\]

<p>We can observe a close connection between Eq.\eqref{MLE} and a discrete variant of Eq.\eqref{girsanov}</p>

<p>Remark: While the Girsanov theorem is commonly employed, it is prone to mistakes that can be easily made. Have I made any such errors?</p>

<h3 id="applications">Applications</h3>

<p>Given a stationary Ornstein-Uhlenbeck process, how do you estimate the parameters using MLE <a class="citation" href="#Grigorios_14">(Pavliotis, 2014)</a>..</p>

\[\begin{align}
\mathrm{d}X_t = -\alpha X_t \mathrm{d}t+\sigma\mathrm{d}W_t.\notag
\end{align}\]

<p>Hint: 1) write the likelihood; 2) take the gradient.</p>]]></content><author><name>Wei Deng</name></author><summary type="html"><![CDATA[Maximum likelihood estimation]]></summary></entry><entry><title type="html">Implicit Ridge Regularization</title><link href="http://localhost:4000/posts/implicit_ridge_regularization/" rel="alternate" type="text/html" title="Implicit Ridge Regularization" /><published>2023-03-06T00:00:00-08:00</published><updated>2023-03-06T00:00:00-08:00</updated><id>http://localhost:4000/posts/Implicit-Ridge-Rgularization</id><content type="html" xml:base="http://localhost:4000/posts/implicit_ridge_regularization/"><![CDATA[<p>We discuss the ordinary least squares (OLS) linear regression</p>

\[\begin{align}
  y=Ax.\notag\\
\end{align}\]

<p>where $X\in \mathbb{R}^{n\times p}$ and a standard solution is $X=(A^\intercal A)^{-1} Ay$</p>

<p>It is known that $X^\intercal X$ is often poor or ill conditioned. To solve this issue and</p>

<p>Ridge regularization is a popular technique in</p>

<p>Linear regression</p>

<p>large n &gt; small d
small n &lt; large d</p>

<p>Minimum-norm estimator</p>

<p>https://arxiv.org/pdf/1805.10939.pdf</p>

<p>why the pseudo-inverse (check this slide: https://ds12.github.io/talks/lectures/lecture4.html#slide16, page ) linear regression corresponds to the solution with minimum norm.</p>

<p>singular value decomposition and/or the Moore-Penrose pseudoinverse.</p>

<p>TBD</p>]]></content><author><name>Wei Deng</name></author><category term="Regression" /><summary type="html"><![CDATA[We discuss the ordinary least squares (OLS) linear regression]]></summary></entry><entry><title type="html">Schrödinger Bridge Problem</title><link href="http://localhost:4000/posts/Bridge/" rel="alternate" type="text/html" title="Schrödinger Bridge Problem" /><published>2022-06-19T00:00:00-07:00</published><updated>2022-06-19T00:00:00-07:00</updated><id>http://localhost:4000/posts/Bridges</id><content type="html" xml:base="http://localhost:4000/posts/Bridge/"><![CDATA[<p>The classical Schrödinger Bridge Problem (SBP) have found interesting applications in deep generative models <a class="citation" href="#Nea11">(Neal, 2011)</a>, <a class="citation" href="#forward_backward_SDE">(Chen et al., 2022)</a>, <a class="citation" href="#DSB">(De Bortoli et al., 2021)</a> and financial mathematics <a class="citation" href="#nutz_trading">(Nutz, 2022)</a> <a class="citation" href="#nutz_portfolio">(Nutz, 2022)</a> <a class="citation" href="#schrodinger_vol_model">(Henry-Labordere, 2019)</a>. The iterative nature in solving this problem shows a great potential to further accelerate the training for score-based generative models, although the later is already the state-of-the-art methods <a href="https://paperswithcode.com/sota/image-generation-on-cifar-10">[Image Generation]</a>.</p>

<p>The most striking feature of this algorithm is its deep mathematical connections to stochastic optimal control, optimal transport, fluid dynamics <a class="citation" href="#siam_review_Sinkhorn_liaisons">(Chen, 2021)</a>, and DNN approximations. As such, we have sufficient tools to understand the underlying theories. We refer interested readers to the Appendix A of <a class="citation" href="#provably_schrodinger_bridge">(Chen et al., 2023)</a>.</p>]]></content><author><name>Wei Deng</name></author><category term="Diffusion Model" /><summary type="html"><![CDATA[The classical Schrödinger Bridge Problem (SBP) have found interesting applications in deep generative models (Neal, 2011), (Chen et al., 2022), (De Bortoli et al., 2021) and financial mathematics (Nutz, 2022) (Nutz, 2022) (Henry-Labordere, 2019). The iterative nature in solving this problem shows a great potential to further accelerate the training for score-based generative models, although the later is already the state-of-the-art methods [Image Generation].]]></summary></entry><entry><title type="html">Hamiltonian Monte Caro</title><link href="http://localhost:4000/posts/Hamiltonian/" rel="alternate" type="text/html" title="Hamiltonian Monte Caro" /><published>2021-11-01T00:00:00-07:00</published><updated>2021-11-01T00:00:00-07:00</updated><id>http://localhost:4000/posts/Hamiltonian</id><content type="html" xml:base="http://localhost:4000/posts/Hamiltonian/"><![CDATA[<p>Hamiltonian Monte Carlo <a class="citation" href="#Nea11">(Neal, 2011)</a> (HMC) is a popular Markov chain Monte Carlo (MCMC) algorithm to simulate from a probability distribution and is believed to be faster than the Metropolis Hasting algorithm <a class="citation" href="#MRRT53">(Metropolis, 1953)</a> and Langevin dynamics. However, the convergence properties are far less understood compared to its empirical successes.</p>

<p>In this blog, I will introduce a paper called Optimal Convergence Rate of Hamiltonian Monte Carlo for Strongly Logconcave Distributions <a class="citation" href="#CV19">(Zongchen Chen, 2019)</a>.</p>

<h2 id="hamiltonian-dynamics">Hamiltonian Dynamics</h2>

<p>HMC algorithms conserves Hamiltonian and the volume in the phase space and enjoy the reversibility condition (by flipping a sign). It aims to simulate particles according to the laws of Hamiltonian dynamics. Consider a Hamiltonian function $H(x, v)$ defined as follows</p>

<p>\begin{equation}\notag
H(x, v)=f(x)+\|v\|^2,
\end{equation}</p>

<p>where $f$ is the potential energy function, $x$ is the position, and $v$ is the velocity variable. In each step, the update of the particles $(x, v)$ follows the system of (ordinary) differential equations as follows</p>

<p>\begin{equation}\label{hmc_eq}
\frac{d x}{d t}=\frac{\partial H}{\partial v}=v(t) \ \ \text{and} \ \ \frac{d v}{d t}=-\frac{\partial H}{\partial x}=-\nabla f(x).
\end{equation}</p>

<p>After a time interval $t$, the solutions follow a ``Hamiltonian flow’’ $\varphi_t$ that maps $(x,v)$ to $(x_t(x,v), v_t(x, v))$.</p>

<h2 id="convergence-of-ideal-hmc">Convergence of Ideal HMC</h2>

<p>To prove the convergence of the ideal HMC algorithms, we first assume standard assumptions.</p>

<p><strong>Strong convexity</strong> We say $f$ is $\mu$-strongly convex if for all $x, y\in R^d$, we have</p>

<p>\begin{equation}\notag
f(y)\geq f(x)+\langle \nabla f(x), y-x\rangle + \frac{\mu}{2} \|y-x\|^2.
\end{equation}</p>

<p><strong>Smoothness</strong> We also assume $f$ is $L$-smooth in the sense that</p>

<p>\begin{equation}\notag
f(y)\leq f(x)+\langle \nabla f(x), y-x\rangle + \frac{L}{2} \|y-x\|^2.
\end{equation}</p>

<p>The convergence analysis hinges on the coupling of two Markov chains such that the distance between the position variables $x_k$ and $y_k$ (the second Markov chain) contracts in each step.</p>

<p>Denote by $x(t)$ and $y(t)$ solutions of HMC (\ref{hmc_eq}) and denote by $x(0)$ and $y(0)$ the initial positions of two ODEs for HMC. To faciliate the analysis of coupling techniques, we adopt the same initial velocity $v(0)=u(0)$. The convergence study hinges on the contraction bound as follows</p>

<p align="center">
    <img src="/images/HMC_coupling2.png" width="400" />
</p>

<p><strong>Lemma</strong> Assume the potential function $f$ satisfies the convexity and smoothness assumptions. Then for $0\leq t \leq \frac{1}{2\sqrt{L}}$, we have</p>

<p>\begin{equation}\notag
\|x(t)-y(t)\|^2 \leq (1-\frac{\mu}{4}t^2) \|x(0)-y(0)\|^2.
\end{equation}</p>

<p><strong>Proof</strong>
Consider two ODEs for HMCs:</p>

\[\begin{align}\notag
\qquad\qquad\qquad\qquad x'(t)&amp;=v(t)    \qquad\qquad \quad\text{and}\qquad y'(t)=u(t) \notag\\\\
\qquad\qquad\qquad\qquad v'(t)&amp;=-\nabla f(x(t))     \quad\qquad\qquad\ \   u'(t)=-\nabla f(y(t)),\notag
\end{align}\]

<p>where the initial velocities follow $u(0)=v(0)$.</p>

<p>Taking the second derivative of $\frac{1}{2}\|x-y\|^2$, we have</p>

\[\begin{align}\notag
\frac{d^2}{dt^2}\left(\frac{1}{2} \|x-y\|^2\right)&amp;=\frac{d}{dt}\langle v-u, x-y \rangle\notag\\
						  &amp;=\langle v'-u', x-y \rangle + \langle v-u, x'-y' \rangle \notag\\
						  &amp;=-\rho \|x-y\|^2 + \|v-u\|^2,\notag
\end{align}\]

<p>where $\rho=\rho(t)=\frac{\langle \nabla f(x) - \nabla f(y), x-y \rangle}{\|x-y\|^2}$.</p>

<p>To upper bound $\|v-u\|^2$, recall that 
\begin{equation}\notag
\frac{d}{dt} \|x\|=\frac{d}{dx} \|x\| \cdot \frac{d}{dt} x=\frac{\langle x, \dot{x} \rangle}{\|x\|}.
\end{equation}</p>

<p>In what follows, we have</p>

<p>\begin{equation}\notag
\frac{d}{dt}\|v-u\|=\frac{1}{\|v-u\|}\langle v’-u’, v-u\rangle =-\frac{\langle \nabla f(x)-\nabla f(y), v-u\rangle}{\|v-u\|}.
\end{equation}</p>

<p>In particular for the upper bound of $\frac{d}{dt}\|v-u\|$, we have</p>

\[\begin{align}
\left|\frac{d}{dt}\|v-u\|\right| &amp;\leq \|\nabla f(x)-\nabla f(y)\| \notag\\
                                 &amp; \leq \sqrt{L \langle \nabla f(x) - \nabla f(y), x-y \rangle} \notag\\
                                 &amp; = \sqrt{L\rho \|x-y\|^2} \notag\\
				 &amp; \leq \sqrt{2L\rho \|x_0-y_0\|^2}, \notag\\
\end{align}\]

<p>where the first inequality follows by Cauchy–Schwarz inequality, the second inequality follows by the L-smoothness assumption, and the last inequality follows by Claim 7 in <a class="citation" href="#CV19">(Zongchen Chen, 2019)</a>.</p>

<p>Now, we can upper bound $\|v-u\|^2$ as follows</p>

\[\begin{align}
\|v-u\|^2 &amp;\leq  \left(\int_0^t \left|\frac{d}{ds}\|v-u\|\right| ds\right)^2 \notag\\
\qquad\qquad &amp; \leq \left(\int_0^t \sqrt{2 L\rho} \|x_0-y_0\| ds\right)^2 \notag\\
\qquad\qquad &amp; \leq 2L t \left(\int_0^t \rho ds\right) \|x_0 - y_0\|^2. \notag\\
\end{align}\]

<p>Define the monotone increasing function</p>

<p>\begin{equation}\notag
P=P(t)=\int_0^t \rho dt,
\end{equation}</p>

<p>where $P(0)=0$ and $\mu t \leq P(t)\leq L t$ for all $t\geq 0$. Then</p>

<p>\begin{equation}\notag
|v-u|^2 \leq 2L t P|x_0-y_0|^2.
\end{equation}</p>

<p>Combining the above upper bounds, we have</p>

<p>\begin{equation}\notag
\frac{d^2}{dt^2} \left(\frac{1}{2}\|x-y\|^2 \right)\leq -\rho \left(\frac{1}{2} \|x_0-y_0\|^2\right)+2Lt P \|x_0-y_0\|^2.
\end{equation}</p>

<p>Define $\alpha(t)=\frac{1}{2} \|x-y\|^2$, then we have</p>

<p>\begin{equation}\notag
\alpha’(t)\leq -\alpha(0) (\rho(t)-4L t P(t)).
\end{equation}</p>

<p>Integrating both sides and combining the fact that $\alpha’(0)=0$, we have</p>

\[\begin{align}
\alpha'(t)&amp;=\int_0^t \alpha'(s) ds \notag\\
\qquad\ &amp;\leq -\int_0^t \alpha(0) (\rho(s)-4L t P(s))ds \notag\\
\qquad\ &amp;\leq -\alpha(t)\left(P(t) - 4LP(t) \int_0^t s ds\right) \notag\\
\qquad\ &amp;=-\alpha(0)P(t)(1-2Lt^2). \notag
\end{align}\]

<p>Choose $t \in [0, \frac{1}{2\sqrt{L}}]$, then we can deduce that
\begin{equation}\notag
\alpha’(t)\leq -\alpha(0) \frac{\mu}{2} t.
\end{equation}</p>

<p>Eventually, we have the desired result such that</p>

<p>\begin{equation}\notag
\alpha(t)=\alpha(0)+\int_0^t \alpha’(s) d s \leq \alpha(0) \left(1-\frac{\mu}{4} t^2\right).
\end{equation}</p>

<p>Setting $t=T=1/(c\sqrt{L})$ for some constant $c\geq 2$, we get</p>

<p>\begin{equation}\notag
|x(T)-y(T)|^2 \leq \left(1-\frac{1}{4c^2 \kappa}\right)|x(0)-y(0)|^2.
\end{equation}</p>

<p>Eventually, we can achieve the convergence in Wasserstein distance such that</p>

<p>\begin{equation}\notag
W^2_2(\nu_k, \pi)\leq E\left[|x_k-y_k|^2\right]\leq \left(1-\frac{1}{4c^2 \kappa}\right)^k O(1).
\end{equation}</p>

<h2 id="discretized-hmc">Discretized HMC</h2>

<p><a class="citation" href="#MV18">(Mangoubi &amp; Vishnoi, 2018)</a> proposed to approximate the Hamiltonian trajectory with a second-order Euler integrator such that</p>

<p>\begin{equation}\notag
\hat{x_{\eta}}(x, v)=x+v \eta - \frac{1}{2} \nabla f(x), \quad \hat{v_{\eta}}(x, v)=v-\eta \nabla f(x) - \frac{1}{2} \eta^2 \nabla^2 f(x) v.
\end{equation}</p>

<p>Since Hessian is expensive to computate and store, an approximation is conducted through</p>

<p>\begin{equation}\notag
\nabla^2 f(x) v \approx \frac{\nabla f(\hat{x_{\eta}}) - \nabla f(x)}{\eta},
\end{equation}</p>

<p>Now, the numerical integrator follows that</p>

<p>\begin{equation}\notag
\hat{x_{\eta}}(x, v)=x+v \eta - \frac{1}{2} \nabla f(x), \qquad \hat{v_{\eta}}(x, v)=v-\frac{1}{2}\eta (\nabla f(x) - \nabla f(\hat{x_{\eta}})).
\end{equation}</p>

<p>It can be shown that such a discretized HMC requires O($d^{\frac{1}{4}} \epsilon^{-\frac{1}{2}}$) gradient evaluations under proper regularity assumptions <a class="citation" href="#MV18">(Mangoubi &amp; Vishnoi, 2018)</a>. Other interesting persepectives can be seen in <a class="citation" href="#Che20">(“Fast Mixing of Metropolized Hamiltonian Monte Carlo: Benefits of Multi-Step Gradients,” 2020)</a>.</p>

<h2 id="conclusions">Conclusions</h2>

<p>Properly tuning the number of leapfrog steps is important for maximizing the contraction to accelerate convergence. From the perspective of methodology, the no-U-turn sampler proposes to automatically adjust the number of leapfrog steps and potentially exploits this idea by checking the inner product of postion and velocity <a class="citation" href="#HG14">(Hoffman, 2014)</a>.</p>]]></content><author><name>Wei Deng</name></author><category term="Monte Carlo Methods" /><summary type="html"><![CDATA[Hamiltonian Monte Carlo (Neal, 2011) (HMC) is a popular Markov chain Monte Carlo (MCMC) algorithm to simulate from a probability distribution and is believed to be faster than the Metropolis Hasting algorithm (Metropolis, 1953) and Langevin dynamics. However, the convergence properties are far less understood compared to its empirical successes.]]></summary></entry><entry><title type="html">Couplings and Monte Carlo Methods (I)</title><link href="http://localhost:4000/posts/Couplings/" rel="alternate" type="text/html" title="Couplings and Monte Carlo Methods (I)" /><published>2021-08-01T00:00:00-07:00</published><updated>2021-08-01T00:00:00-07:00</updated><id>http://localhost:4000/posts/Coupling</id><content type="html" xml:base="http://localhost:4000/posts/Couplings/"><![CDATA[<p>A coupling of two random variables/ vectors represents a joint distribution, where the marginal distributions are denoted by $p$ and $q$, respectively. Any joint distributions of $p$ and $q$ define a valid coupling. Although there are infinitely many of them, some of them are quite special and may facilitate our analysis.</p>

<h1 id="maximal-coupling">Maximal Coupling</h1>

<p>Total variation distance is defined as follows</p>

<p>\begin{equation}\notag
\forall A\in X, \quad |p-q|_{\text{TV}}=\sup_{X\in A} \mathbb{P}(X\in A) - \mathbb{P}(Y\in A),
\end{equation}
where $X$ and $Y$ are random variables defined on the state space $\mathbb{X}$ with measurable set $X$. Note that for any measurable set $A\in X$, the follow inequality always holds</p>

<p>$\mathbb{P}(X\in A)- \mathbb{P}(Y\in A)=\mathbb{P}(X\in A \cap X\neq Y)- \mathbb{P}(Y\in A \cap X\neq Y)\leq \mathbb{P}(X\neq Y)$.</p>

<p>There exists one pair of $(X,Y)$ such that the above inequality holds. Any coupling that satisfies this property is known as <strong>maximal coupling</strong>.</p>

<p>Denoting by $\nu=p-q$ the zero-mass measure, there is a set $D$ according to the Hahn-Jordan decomposition such that $\nu^{+}=(p-q)(\cdot \cap D)$ and $\nu^{-}=(q-p)(\cdot \cap D^c)$ are both positive measures and $\nu=\nu^{+}-\nu^-$.</p>

<p>Notably, it is clear that $D=\{x:\ p(x)\geq q(x)\}$. It follows that $\sup_{A\in {X}} \mathbb{P}(X\in A)- \mathbb{P}(Y\in A)=\sup_{A\in {X}}\nu(A)=\nu(D)=\mathbb{P}(X\in D)-\mathbb{P}(Y\in D)$. We have</p>

\[\begin{align}
\mathbb{P}(X\in D)-\mathbb{P}(Y\in D)&amp;=\int_{\{x:\ p(x)\geq q(x)\}} p(x) d x - \int_{\{x:\ p(x) \geq q(x)\}} q(x) d x\nonumber\\
&amp;=\int_{\{x:\ p(x)&lt; q(x)\}} q(x) d x - \int_{\{x:\ p(x) &lt; q(x)\}} p(x) d x.\nonumber
\end{align}\]

<p align="center">
    <img src="/images/TS_distance.png" width="600" />
</p>
<p>Summing up the above equations and combining $|a-b|=a+b-2 a\wedge b$, we can obtain the area between the two pdf curves <a class="citation" href="#Jacob_Pierre">(Jacob, 2021)</a></p>

<p>\begin{equation}\notag
|p-q|_{\text{TV}}=\frac{1}{2} \int |p(x)- q(x)| d x = 1-\int \min \{p(x), q(x) \} dx.
\end{equation}</p>

<p>In the end, we can summarize the different formulations of total variation
\(\begin{align}\notag
\|p-q\|_{\text{TV}}&amp;=\sup \mathbb{P}(X\in A)- \mathbb{P}(Y\in A)\\
		   &amp;=\frac{1}{2}\int |p(x)- q(x)| d x\notag\\
		   &amp;=1-\int \min\{p(x), q(x)\} d x\notag\\
		   &amp;=\inf_{(X,Y)\in \text{coupling}(p, q)} \mathbb{P}(X\neq Y).\notag
\end{align}\)</p>

<h3 id="applications">Applications</h3>

<p>Suppose $(X_i)$ follow an (independent) binomial distribution $Binomial(\lambda, N)$ and $(Y_i)$ follow an (independent) Poisson distribution $Poisson(\lambda)$. Next, we couple $X_i$ and $Y_i$ maximally. The <strong>overlap mass</strong> is equal to $(1-\lambda)\wedge e^{-\lambda} + \lambda \wedge \lambda e^{-\lambda}=1-\lambda+\lambda e^{-\lambda}$. That means $\mathbb{P}(X_i\neq Y_i)=\lambda(1-e^{-\lambda})\leq \lambda^2$.</p>

<p>Replace $\lambda$ with $\lambda/N$, we have
\begin{equation}\notag
\mathbb{P}\left(\frac{\sum_{i=1}^N X_i-\sum_{i=1}^N Y_i}{N}\right)\leq \frac{\lambda^2}{N},
\end{equation}
where implies that given a large N and a fixed $\lambda$, Poisson distribution approximates the binomial distribution.</p>

<h3 id="convergence-rates">Convergence rates</h3>

<p>By assuming $(Y_t)$ is simulated from the stationary distribution in the beginning, we can introduce a coupling inequality such that</p>

<p>\begin{equation}\notag
{L}(X_t)-{L}(Y_t)| \leq \mathbb{P}(\tau&gt;t),
\end{equation}
where $\tau$ is a random variable that enables $X_t=Y_t$ and is also known as ‘‘meeting time’’. The equality can be achieved given the maximal coupling but the contruction may differ in different problems. In addition, meeting exactly sometimes is quite restricted; it is enough to consider close enough chains.</p>

<h1 id="synchronous-coupling">Synchronous Coupling</h1>

<p>Synchronous coupling models the contraction of a pair of trajectories and can be used to prove the convergence of stochastic gradient Langevin dynamics for strongly log-concave distributions.</p>

<p>Let $\theta_k\in \mathbb{R}^d$ be the $k$-th iterate of the following stochastic gradient Langevin algorithm.
\begin{align}\notag
    \theta_{k+1}=\theta_k -\eta \nabla \widetilde f(\theta_k)+\sqrt{2\tau\eta}\xi_k,
\end{align}
where $\eta$ is the learning rate, $\tau$ is the temperature, $\xi_k$ is a standard $d$-dimensional Gaussian vector, and $\nabla \widetilde f(\theta)$ is an unbiased estimate of the exact gradient $\nabla f(\theta)$.</p>

<h2 id="assumptions">Assumptions</h2>

<p><strong>Smoothness</strong> We say $f$ is $L$-smooth if for some $L&gt;0$
\begin{align}\label{def:strong_convex}
f(y)\leq f(x)+\langle \nabla f(x),y-x \rangle+\frac{L}{2}\| y-x \|^2_2\quad \forall x, y\in \mathbb{R}^d.
\end{align}</p>

<p><strong>Strong convexity</strong>
We say $f$ is $m$-strongly convex if for some $m&gt;0$
\begin{align}\label{def:smooth}
f(x)\geq f(y)+\langle \nabla f(y),x-y \rangle + \frac{m}{2} \| y-x \|_2^2\quad \forall x, y\in \mathbb{R}^d.
\end{align}</p>

<p><strong>Bounded variance</strong> The variance of stochastic gradient $\nabla \widetilde f(x)$ is upper bounded such that
\begin{align}\label{def:variance}
\mathbb{E}[\|\nabla \widetilde f(x)-\nabla f(x)\|^2] \leq \sigma^2 d,\quad \forall x\in \mathbb{R}^d.
\end{align}</p>

<h2 id="a-crude-estimate">A Crude Estimate</h2>

<p>Assume assumptions \ref{def:strong_convex}, \ref{def:smooth}, and \ref{def:variance} hold. For any learning rate $\eta \in (0 , 1 \wedge {m}/{L^2} )$  and $|| \theta_0-\theta_* || \leq \sqrt{d} {D}$, where $\theta_*$ is a stationary point. Then</p>

<p>\begin{align}\notag
W_2(\mu_k, \pi) \leq e^{-{mk\eta}/{2}} \cdot 2 ( \sqrt{d} {D} + \sqrt{d/m} ) + \sqrt{ 2d (\sigma^2+L^2 G\eta) / m^2},
\end{align}</p>

<p>where $\mu_k$ denotes the probability measure of $\theta_k$ and $G:=25(\tau+m {D}^2+\sigma^2)$.</p>

<h2 id="proof">Proof</h2>
<p>Denote $\theta_t$ as the continuous-time interpolation of the stochastic gradient Langevin dynamics as follows</p>

<p>\begin{align}\notag
d \theta_t = - \nabla \widetilde f(\theta_{\eta\lfloor\frac{t}{\eta} \rfloor}) d t + \sqrt{2\tau} d \widetilde W_t,
\end{align}</p>

<p>where ${\theta}_0=\theta_0$. For any $k\in \mathbb{N}^{+}$ and a time $t$ that satisfies $t=k\eta$, it is apparent that $\widehat\mu_t={L}({\theta}_t)$ is the same as $\mu_k={L}(\theta_k)$, where ${L}(\cdot)$ denotes a distribution of a random variable. In addition, we define an auxiliary process $(\beta_t)$ that starts from the stationary distribution $\pi$</p>

<p>\begin{align}\notag
d \beta_t = - \nabla f(\beta_t) d t + \sqrt{2\tau} d W_t.
\end{align}</p>

<p>Consider Itô’s formula for the sequence of $\frac{1}{2}  \| \theta_t - \beta_t \| ^2$</p>

\[\begin{align}\notag
&amp;\ \ \ \frac{1}{2} d  \| \theta_t - \beta_t \|^2\notag\\
&amp;= \langle \theta_t - \beta_t, d \theta_t - d \beta_t \rangle + \mathrm{Tr}[ d^2 \theta_t - d^2 \beta_t ]\notag\\
&amp;=\langle \theta_t - \beta_t, (\nabla f(\beta_t) -\nabla\widetilde  f(\theta_{\eta\lfloor\frac{t}{\eta} \rfloor}) ) d t + \sqrt{2\tau} ( d \widetilde W_t - d W_t ) \rangle + 2\tau \mathrm{Tr}[ d^2 \widetilde W_t - d^2 W_t ].\notag
\end{align}\]

<p>Taking $\widetilde W_t=W_t$ defines a synchronous coupling. Arrange the terms</p>

\[\begin{align}\notag
&amp;\ \ \ \frac{1}{2} d \| \theta_t - \beta_t \|^2 \notag\\
&amp;= \langle \theta_t - \beta_t, \nabla f(\beta_t)-\nabla f(\theta_t) \rangle d t+ \langle \theta_t - \beta_t,  \nabla f(\theta_{t}) - \nabla f(\theta_{\eta\lfloor\frac{t}{\eta} \rfloor})  \rangle d t\notag\\
&amp;\qquad \qquad\qquad+ \langle \theta_t - \beta_t, \nabla f(\theta_{\eta\lfloor\frac{t}{\eta} \rfloor}) - \nabla \widetilde f(\widehat \theta_{\eta\lfloor\frac{t}{\eta} \rfloor}) \rangle d t \notag\\
&amp;\leq - m \| \theta_t - \beta_t \|^2 d t + \frac{m}{4} \| \theta_t - \beta_t \|^2 d t + \frac{1}{m}  \| \nabla f(\theta_{t}) - \nabla f(\theta_{\eta\lfloor\frac{t}{\eta} \rfloor})  \|^2 d t \notag\\
&amp;\qquad\qquad  + \frac{m}{4} \| \theta_t - \beta_t \|\|^2 d t + \frac{1}{m} \| \nabla f(\theta_{\eta\lfloor\frac{t}{\eta} \rfloor}) - \nabla \widetilde f(\widehat \theta_{\eta\lfloor\frac{t}{\eta} \rfloor}) \|^2 d t\notag\\
&amp;\leq  - \frac{m}{2} \| \theta_t - \beta_t \|\|^2 d t + \frac{d\sigma^2}{m} d t +\frac{1}{m} \| \nabla f(\theta_{t}) - \nabla f(\theta_{\eta\lfloor\frac{t}{\eta} \rfloor}) \|^2  d t\notag\\
&amp;\leq  - \frac{m}{2} \| \theta_t - \beta_t \|^2 d t + \frac{d\sigma^2}{m} d t+ \frac{L^2}{m} \| \theta_{t} - \theta_{\eta\lfloor\frac{t}{\eta} \rfloor} \|^2  d t\notag\\
\end{align}\]

<p>where the first inequality follows from $ab\leq  (\frac{\sqrt{m}}{2}a)^2+({\frac{1}{\sqrt{m}}}b)^2$ and the strong-convexity property \ref{def:strong_convex}; in particular, we don’t attempt to optimize the constants of $-\frac{m}{2}$ for the item $|| \theta_t - \beta_t ||^2$; the second and third inequalities follow by bounded variance assumption \ref{def:variance} and the smoothness assumption \ref{def:smooth}, respectively.</p>

<p>Now apply Grönwall’s inequality to the preceding inequality and take expectation respect to a coupling $(\theta_t, \beta_t) \sim \Gamma(\widehat\mu_t,\pi)$
\begin{align}\label{eq:1st_gronwall}
     \mathbb{E}{ \|\theta_t - \beta_t \|^2}\leq  \mathbb{E}{\| \theta_0 - \beta_0 \|^2} e^{-mt}+\frac{2}{m}\int_0^t g(d\sigma^2+ L^2\underbrace{\mathbb{E}{ \| \theta_{s} - \theta_{\eta\lfloor\frac{s}{\eta} \rfloor} \|^2 }}_{I: \text{Discretization error}} g) e^{-(t-s)m} d s. 
\end{align}</p>

<p>Plugging some estimate of $I$ into Eq.\eqref{eq:1st_gronwall}, we have
\(\begin{align}\notag
&amp;\ \ \ \mathbb{E}{ \| \theta_t - \beta_t \|^2 }\\
&amp;\leq  \mathbb{E}{ \| \theta_0 - \beta_0 \|^2} e^{-mt}+\frac{2d}{m} (\sigma^2+L^2 G\eta) \int_0^t  e^{-(t-s)m} d s\notag\\
&amp;\leq \mathbb{E}{ \| \theta_0 - \beta_0 \|^2} e^{-mt}+\frac{2d}{m^2} (\sigma^2+L^2 G\eta).\notag
\end{align}\)</p>

<p>Recall that $\theta_k$ and $\widehat\theta_{t\eta}$ have the same distribution $\mu_k$. By the definition of $W_2$ distance, we have</p>

\[\begin{align}\notag
&amp;\ \ \ W_2(\mu_k, \pi)\\
&amp;\leq e^{-{mk\eta}/{2}} \cdot W_2(\mu_0, \pi) + \sqrt{ 2d (\sigma^2+L^2 G\eta) / m^2}\notag\\
&amp;\leq e^{-{mk\eta}/{2}} \cdot 2 (\| \theta_0 - \theta_* \| +  \sqrt{d/m} )+ \sqrt{ 2d(\sigma^2+L^2 G\eta) / m^2}\notag\\
&amp;\leq e^{-{mk\eta}/{2}} \cdot 2 ( \sqrt{d} {D} +  \sqrt{d/m} )+  \sqrt{ 2 d(\sigma^2+L^2 G\eta) / m^2},\notag
\end{align}\]

<p>where the first inequality follows by applying $\sqrt{| a + b |} \leq \sqrt{| a |} + \sqrt{| b |}$, the second one follows by an estimate of $W_2(\mu_0, \pi)$, and the last step follows from the initialization condition.</p>

<h3 id="remark-how-to-achieve-a-sharper-upper-bound">Remark: How to achieve a sharper upper bound?</h3>]]></content><author><name>Wei Deng</name></author><category term="Coupling" /><summary type="html"><![CDATA[A coupling of two random variables/ vectors represents a joint distribution, where the marginal distributions are denoted by $p$ and $q$, respectively. Any joint distributions of $p$ and $q$ define a valid coupling. Although there are infinitely many of them, some of them are quite special and may facilitate our analysis.]]></summary></entry><entry><title type="html">The Lyapunov Function Method for Poincaré Inequality</title><link href="http://localhost:4000/posts/Lyapunov_Poincare/" rel="alternate" type="text/html" title="The Lyapunov Function Method for Poincaré Inequality" /><published>2021-06-01T00:00:00-07:00</published><updated>2021-06-01T00:00:00-07:00</updated><id>http://localhost:4000/posts/Lyapunov-Poincare</id><content type="html" xml:base="http://localhost:4000/posts/Lyapunov_Poincare/"><![CDATA[<p>Poincaré (spectral gap) inequality <a class="citation" href="#Bakry08">(Bakry et al., 2008)</a> is the first important family of functional inequalities that charaterizes the exponential convergence of a random variable towards the equilibrium.</p>

<h2 id="langevin-diffusion">Langevin diffusion</h2>

<p>Suppose we are interested in the convergence of the stochastic differential equation</p>

<p>\begin{equation}\notag
dx_t = -\nabla U(x_t)dt + \sqrt{2}dW_t,
\end{equation}</p>

<p>where $\nabla U(\cdot)$ denotes the gradient of a energy function $U$ and $(W_t)_{t\geq 0}$ is a Brownian motion. Under mild growth conditions on $U(\cdot)$, $x$ converges to a stationary measure $\mu(x)\propto e^{-U(x)}$.</p>

<p>Define a family of operators $(P_t)_{t\geq 0}$ as follows</p>

<p>\begin{equation}\notag
P_t(f(x)) = E[f(x_t)|$=x],
\end{equation}
where the expectation is taken over a particular set to denote the conditional density.</p>

<p>For a smooth test function $f(x)$, Itô’s formula implies that</p>

<p>\begin{equation}\notag
d f(x_t) = \sqrt{2} \nabla f(x_t) dB_t + Lf(x_t)dt,
\end{equation}
where $L$ is the infinitesimal generator of the symmetric Markov Semigroup $P_t$</p>

<p>\begin{equation}\notag
Lf=\lim_{t\rightarrow 0} \frac{P_t f -f }{t}=\Delta f - \langle\nabla U, \nabla f\rangle,
\end{equation}
where $\Delta$ denotes the Laplace operator.</p>

<h2 id="poincaré-inequality">Poincaré Inequality</h2>

<p>We say the Gibbs measure $\mu$ satisfies a Poincaré equality with a constant $C$ if</p>

<p>\begin{equation}\notag
Var_{\mu}(f)=\int f^2 d\mu -(\int f d\mu)^2 \leq C \xi(f),
\end{equation}
where $\xi$ is the Dirichlet form defined as</p>

<p>\begin{equation}\notag
\xi(f)=\int \Gamma(f)d\mu.
\end{equation}</p>

<p>$\Gamma$ is the Carré du Champ operator satisfying</p>

<p>\begin{equation}\notag
\Gamma(f)=\frac{1}{2}(L(f^2)-2 f L(f)). 
\end{equation}
Since $\mu$ is reversible for $P_t$, we have the invariance property $\int L(f)=0$ for all f in the Dirichlet domain. In other words, for symmetric $\mu$, we have</p>

<p>\begin{equation}\notag
\xi(f)=\int \Gamma(f)d\mu=-\int f L(f) d\mu =\int (\nabla f)^2 d\mu.
\end{equation}
where the last inequality follows by integration by parts such that: $-\int f L(f) d\mu=-\int f\nabla (e^{-U(x)}\nabla f)dx=-\int f d(e^{-U(x)} \nabla f)=f e^{-U(x)} \nabla f|_{boundary} + \int (\nabla f)^2 d\mu.$</p>

<h2 id="variance-decay">Variance Decay</h2>

<p>Now we study the decay of variance</p>

<p>\begin{equation}\notag
\Lambda(t)=Var_{\mu}(P_t f)= \int(P_t f)^2d\mu.
\end{equation}
Reacll $\xi(f)=-\int f L(f) d\mu$. Taking the derivative</p>

<p>\begin{equation}\notag
\Lambda_t(t)=2\int P_t f L P_t f d\mu = -2 \xi(P_t f).
\end{equation}</p>

<p>Combining the Poincaré equality, we have that</p>

<p>\begin{equation}\notag
\Lambda(t)=Var_{\mu}(P_t f)\leq C \xi(P_t f)=-\frac{C}{2}\Lambda_t(t)
\end{equation}
This means that $\Lambda_t(t)\leq -\frac{2}{C} \Lambda(t)$. Including an integration factor $e^{\frac{2t}{C}}$, we have</p>

<p>\begin{equation}\notag
\nabla (\Lambda(t) e^{\frac{2t}{C}})=\Lambda_t(t) e^{\frac{2t}{C}} + \Lambda(t) \frac{2}{C} e^{\frac{2t}{C}}\leq 0.
\end{equation}
Hence $\Lambda(t) e^{\frac{2t}{C}} \leq \Lambda(0)$. In other words,</p>

<p>\begin{equation}\notag
Var_{\mu}(P_t f)\leq e^{-2t/C} Var_{\mu}(f).
\end{equation}</p>

<h2 id="how-to-identify-the-poincaré-constant">How to identify the Poincaré constant</h2>

<p>Despite the appealing formulation, identifying the best constant $C&gt;0$ is in general not easy. In this blog, we will show a method for determining a crude estimate of such a constant.</p>

<p>We denote a Lyapunov function by $V$ if $V\geq 1$ and if there exist $\lambda&gt;0, b\geq 0$ and some $R &gt; 0$ such that for all $x$, the following drift condition holds</p>

<p>\begin{equation}\notag
LV(x) ≤ -\lambda V(x) + b 1_{B(0, R)}(x).
\end{equation}</p>

<h3 id="by-theorem-14-1-we-show-that-if-there-exists-a-lyapunov-function-vx-satisfying-the-drift-condition-then-mu--satisfies-a-l2-poincaré-inequality-with-constant-c_pfrac1lambda1bkappa_r-where-kappa_r-is-the-l2-poincaré-constant-of-mu-restricted-to-the-ball-b0r">By Theorem 1.4 [1], we show that if there exists a Lyapunov function $V(x)$ satisfying the drift condition, then $\mu $ satisfies a $L^2$ Poincaré inequality with constant $C_P=\frac{1}{\lambda}(1+b\kappa_R)$, where $\kappa_R$ is the L2 Poincaré constant of $\mu$ restricted to the ball B(0,R).</h3>

<p>Given a smooth function $g$, we know that $Var_{{\mu}}(g)\leq \int (g-c)^2 d\mu$ for all $c$. In what follows, we set $f=g-c$, where $c$ is a constant to be selected later.</p>

<p>Next, we reformulate the drift condition and take an integral for $f^2$ with respect to $\mu$:</p>

<p>\begin{equation}\notag
\int f^2 d\mu \leq \int \frac{-LV}{\lambda V} f^2 d\mu + \int f^2 \frac{b}{\lambda V}1_{B(0, R)}d \mu.
\end{equation}</p>

<h3 id="control-the-first-term-int-frac-lvlambda-v-f2-dmu">Control the first term $\int \frac{-LV}{\lambda V} f^2 d\mu$</h3>

<p>Since $L$ is $\mu$-symmetric, by integration by parts, we get</p>

<p>$\int \frac{-LV}{V}f^2d \mu= \int \nabla\left(\frac{f^2}{V}\right) \nabla V d\mu$</p>

<p>$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  =2\int \frac{f}{V} \nabla f \nabla V d\mu  - \int \frac{f^2}{V^2} |\nabla V|^2 d\mu$</p>

<p>$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\int |\nabla f|^2 d\mu - \int |\nabla f - \frac{f}{V} \nabla V|^2 d\mu$</p>

<p>$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \leq \int |\nabla f|^2 d\mu$</p>

<h3 id="control-the-second-term-int-f2-fracblambda-v1_b0-r-dmu">Control the second term $\int f^2 \frac{b}{\lambda V}1_{B(0, R)} d\mu$</h3>

<p>Since $\mu$ satisfies a Poincaré inequality on $B(0, R)$ with a constant $\kappa_R$, we have</p>

<p>\begin{equation}\notag
\int_{B(0, R)} f^2 d\mu\leq \kappa_R \int_{B(0, R)} |\nabla f|^2 d\mu + (1/\mu(B(0, R))) \left(\int_{B(0, R)} fd\mu\right)^2.
\end{equation}</p>

<p>Fix $c=\int_{B(0, R)} gd\mu$. We have
\begin{equation}\notag
\int_{B(0, R)} \frac{f^2}{V}d\mu\leq \int_{B(0, R)} f^2 d\mu\leq \kappa_{R}\int_{B(0, R)} |\nabla f|^2d\mu.
\end{equation}
Eventually, we have</p>

<p>\begin{equation}\notag
Var_{\mu}(f)=\int f^2 d\mu \leq \frac{1}{\lambda} (1+b\kappa_R) \int |\nabla f|^2 d\mu.
\end{equation}
In other words, the Poincaré inequality has a crude constant $C_p=\frac{1}{\lambda} (1+b \kappa_R)$.</p>

<h2 id="construction-of-the-lypunov-function">Construction of the Lypunov function</h2>

<p>Suppose we require one tail condition of the energy function $U(x)$, i.e. there exist $\alpha &gt;0$ and $R\geq 0$ such that</p>

<h3 id="assumption-langle-x-nabla-uxrangle-geq-alpha-x-for-all-xgeq-r-c1">Assumption $\langle x, \nabla U(x)\rangle \geq \alpha |x|$ for all $|x|\geq R$ (C1)</h3>

<p>Now it is sufficient to build a Lyapunov function $V(x)=e^{\gamma |x|}$, where $|x|=\sqrt{\sum_{i=1}^n x_i^2}$.</p>

<p>Note that $\frac{\partial V(x)}{\partial x_i}= \gamma \frac{x_i}{|x|} V(x)$ and $\frac{\partial^2 V(x)}{\partial x_i^2}=\frac{\gamma}{|x|} V(x)+ \gamma^2 \frac{x_i^2}{|x|^2} V(x) - \gamma \frac{x_i^2}{|x|^3}V(x)$.</p>

<p>In the sequel, we have</p>

<p>$LV(x)=\gamma\left(\frac{n-1}{|x|}+\gamma-\frac{x}{|x|} \nabla U(x)\right) V(x)$</p>

<p>$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \leq \gamma\left(\frac{n-1}{|x|} + \gamma -\alpha \right) V(x)$</p>

<p>$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \leq -\gamma(\alpha-\gamma-\frac{n-1}{R}) V(x) + b 1_{B(0, R)}(x)$.</p>

<p>Hence $V(x)$ is a Lyapunov function provided</p>

<p>\begin{equation}\notag
\lambda = \gamma(\alpha-\gamma-\frac{n-1}{R})&gt;0,
\end{equation}</p>

<p>which suffices to choose $\gamma&lt;\alpha$, a large $R$ and assume the (C1) condition.</p>

<h2 id="discussions">Discussions</h2>

<p>[1] The construction of Lyapunov function implies a tail decay for the distribution $\mu\propto e^{-U(x)}$ outside the ball $B(0, R)$.</p>

<p>[2] Obtaining a sharper estimate of Poincaré constant may require isoperimetric inequality.</p>]]></content><author><name>Wei Deng</name></author><category term="Functional Inequality" /><summary type="html"><![CDATA[Poincaré (spectral gap) inequality (Bakry et al., 2008) is the first important family of functional inequalities that charaterizes the exponential convergence of a random variable towards the equilibrium.]]></summary></entry><entry><title type="html">Replica Exchange and Variance Reduction</title><link href="http://localhost:4000/posts/replica/" rel="alternate" type="text/html" title="Replica Exchange and Variance Reduction" /><published>2021-05-01T00:00:00-07:00</published><updated>2021-05-01T00:00:00-07:00</updated><id>http://localhost:4000/posts/VR-reSGLD</id><content type="html" xml:base="http://localhost:4000/posts/replica/"><![CDATA[<p>Variance-reduced sampling algorithms <a class="citation" href="#Dubey16">(Dubey et al., 2016)</a> <a class="citation" href="#Xu18">(Xu et al., 2018)</a> are not widely adopted in practice. Alternatively, we focus on the energy variance reduction to exploit exponential accelerations but no longer consider the gradient variance reduction.</p>

<p>To this end, we consider a standard sampling algorithm, the stochastic gradient Langevin dynamics (SGLD), which is a mini-batch numerical discretization of a stochastic differential equation (SDE) as follows:</p>

<p>\begin{equation}
\beta_{k+1}=\beta_k - \eta \frac{N}{n}\nabla \sum_{i\in B} L(x_i|\beta_k) + \sqrt{2\eta\tau_1} \xi_k,
\end{equation}</p>

<p>where $\beta\in\mathbb{R}^d$, $L(x_i|\beta)$ is the energy function based on the i-th data point and B denotes a data set of size $n$ simulated from the whole data of size $N$. $\xi$ is a d-dimensional Gaussian vector. It is known that a non-convex $U(\cdot)$ often leads to an exponentially slow mixing rate.</p>

<!--- Simulated annealing is adopted in almost every espect in deep learning, which proposes to anneal temperatures to concentrate the probability measures towards the global optima. Such a strategy, however, fails in uncertainty estimations for reliable predictions. -->

<p>To accelerate the simulations, replica exchange proposes to run multiple stochastic processes with different temperatures, where interactions between different SGLD chains are conducted in a manner that encourages large jumps <a class="citation" href="#yin_zhu_10">(Yin &amp; Zhu, 2010)</a> <a class="citation" href="#chen2018accelerating">(Chen et al., 2019)</a> <a class="citation" href="#deng2020">(Deng et al., 2020)</a> <a class="citation" href="#deng_VR">(Deng et al., 2021)</a>.</p>

<!--- The following is a figure that shows the trajectory of the algorithm, where the right path denotes a process driven by a high temperature and the blue one denotes a low-temperature process. -->

<p align="center">
    <img src="/images/reSGLD_exploitation_exploration.png" width="500" height="220" />
</p>

<p>In particular, the parameters swap the positions with a probability $1\wedge S(\beta^{(1)}, \beta^{(2)})$</p>

<p>\begin{equation}
S(\beta^{(1)}, \beta^{(2)})=e^{\left(\frac{1}{\tau_1}-\frac{1}{\tau_2}\right)\left(\frac{N}{n}\sum_{i\in B} L(x_i|\beta^{(1)})-\frac{N}{n}\sum_{i\in B} L(x_i|\beta^{(2)})-(\frac{1}{\tau_1}-\frac{1}{\tau_2})\sigma^2\right)},
\end{equation}</p>

<p>where $\sigma^2$ is the variance of the noisy estimators $\sum_{i\in B} L(x_i|\cdot)$. Under Normality assumptions, the above rule leads to an unbiased swapping probability, which satisfy the detailed balance in a stochastic sense. However, the efficiency of the swaps are significantly reduced due to the requirement of corrections to avoid biases.</p>

<p>The desire to obtain more effective swaps drives us to design more efficient energy estimators. To reduce the variance of the noisy energy estimator $L(B|\beta^{(h)})=\frac{N}{n}\sum_{i\in B}L(x_i|\beta^{(h)})$ for $h\in{1,2}$, we consider an unbiased estimator $L(B|\widehat\beta^{(h)})$ for $\sum_{i=1}^N L(x_i|\widehat\beta^{(h)})$ and a constant $c$, we see that a new estimator $\widetilde L(B| \beta^{(h)})$, which follows
\begin{equation}
    \widetilde L(B|\beta^{(h)})= L(B|\beta^{(h)}) +c\left( L(B|\widehat\beta^{(h)}) -\sum_{i=1}^N L (x_i| \widehat \beta^{(h)})\right),
\end{equation}
is still the unbiased estimator for $\sum_{i=1}^N L(x_i| \beta^{(h)})$. Moreover, energy variance reduction potentially increases the swapping efficiency exponentially given a larger batch size $n$, a small learning rate $\eta$, and a more frequent update of control variate $\widehat \beta$, i.e. a small $m$</p>

<p>\begin{equation}
Var\left(\widetilde L(B|\beta^{(h)})\right)\leq O\left(\frac{m^2 \eta}{n}\right).
\end{equation}</p>

<p>The following shows a demo that explains how variance-reduced reSGLD works.</p>

<p float="left" align="center">
  <img src="/images/VR-reSGLD/SGLD.gif" width="185" title="SGLD" />
  <img src="/images/VR-reSGLD/reSGLD_vs_VR_reSGLD.gif" width="340" alt="Made with Angular" title="reSGLD vs VR-reSGLD" />
</p>]]></content><author><name>Wei Deng</name></author><category term="Monte Carlo Methods" /><summary type="html"><![CDATA[Variance-reduced sampling algorithms (Dubey et al., 2016) (Xu et al., 2018) are not widely adopted in practice. Alternatively, we focus on the energy variance reduction to exploit exponential accelerations but no longer consider the gradient variance reduction.]]></summary></entry></feed>