---
title: 'Tweedie formula and Pitfalls'
subtitle: A simple empirical Bayesian posterior mean
date: 2024-12-25
permalink: /posts/tweedie_formula/
category: Theory
---


Assume 

$$\begin{align}
    Y = \alpha X + \sigma Z,
\end{align}$$
where $Z \sim \mathcal{N, 0, I}$.



$$\begin{align}
    \nabla_{Y} \log p_Y(y) &= \frac{1}{p_Y(y)} \nabla_{Y} p_Y(y) \\
                           &= \frac{1}{p_Y(y)} \nabla_{Y} \int p_Y(y|x) p(x) d x \\
                           &= \frac{1}{p_Y(y)} \int \nabla_{Y} p_Y(y|x) p(x) d x \\
                           &= \frac{1}{p_Y(y)} \int p_Y(y|x) \nabla_{Y} \log p_Y(y|x) p(x) d x \\
                           &= \int p_Y(x|y) \nabla_{Y} \log p_Y(y|x) d x \\
                           &= \int p_Y(x|y) \frac{\alpha x-y}{\sigma^2} d x \\
                           &= \frac{\alpha E[x|y] - y}{\sigma^2} \\
\end{align}$$


